System.register(["./coordinates-converts-utils-bf8713a9.js","./event-enum-5a5aa40e.js","./view-7d20208a.js"],(function(e){"use strict";var n,t,r,s,l,u,c,i,o,E,a,h;return{setters:[function(e){n=e.bM,t=e.bL,r=e.e3,s=e.c,l=e.d,u=e.l,c=e.c3},function(e){i=e.q,o=e.r,E=e.l},function(e){a=e.V,h=e.i}],execute:function(){n(a.prototype,"View.prototype",[{name:"isAntiAliasEnabled",suggest:"The API of Texture2d have been largely modified, no alternative"},{name:"enableAntiAlias",suggest:"The API of Texture2d have been largely modified, no alternative"}]),t(i,"Node.EventType",[{name:"POSITION_PART",newName:"TRANSFORM_CHANGED"},{name:"ROTATION_PART",newName:"TRANSFORM_CHANGED"},{name:"SCALE_PART",newName:"TRANSFORM_CHANGED"}]);var _=null,f=null,v=null,m=null,O=e("S",function(e){function n(){return e.call(this)||this}r(n,e);var t=n.prototype;return t.setAccelerometerEnabled=function(e){e&&window.DeviceMotionEvent&&"function"==typeof DeviceMotionEvent.requestPermission?DeviceMotionEvent.requestPermission().then((function(e){s(3520,e),h.setAccelerometerEnabled("granted"===e)})).catch((function(e){l(3521,e.message),h.setAccelerometerEnabled(!1)})):h.setAccelerometerEnabled(e)},t.setAccelerometerInterval=function(e){h.setAccelerometerInterval(e)},t.on=function(n,t,r,s){return e.prototype.on.call(this,n,t,r,s),n!==i.KEY_DOWN&&n!==i.KEY_UP||_||(_=o.create({event:o.KEYBOARD,onKeyPressed:function(e,n){n.type=i.KEY_DOWN,S.emit(n.type,n)},onKeyReleased:function(e,n){n.type=i.KEY_UP,S.emit(n.type,n)}}),E.addListener(_,256)),n===i.DEVICEMOTION&&(f||(f=o.create({event:o.ACCELERATION,callback:function(e,n){n.type=i.DEVICEMOTION,u.systemEvent.emit(n.type,n)}}),E.addListener(f,256))),n!==i.TOUCH_START&&n!==i.TOUCH_MOVE&&n!==i.TOUCH_END&&n!==i.TOUCH_CANCEL||v||(v=o.create({event:o.TOUCH_ONE_BY_ONE,onTouchBegan:function(e,n){return n.type=i.TOUCH_START,u.systemEvent.emit(n.type,e,n),!0},onTouchMoved:function(e,n){n.type=i.TOUCH_MOVE,u.systemEvent.emit(n.type,e,n)},onTouchEnded:function(e,n){n.type=i.TOUCH_END,u.systemEvent.emit(n.type,e,n)},onTouchCancelled:function(e,n){n.type=i.TOUCH_CANCEL,u.systemEvent.emit(n.type,e,n)}}),E.addListener(v,256)),n!==i.MOUSE_DOWN&&n!==i.MOUSE_MOVE&&n!==i.MOUSE_UP&&n!==i.MOUSE_WHEEL||m||(m=o.create({event:o.MOUSE,onMouseDown:function(e){e.type=i.MOUSE_DOWN,u.systemEvent.emit(e.type,e)},onMouseMove:function(e){e.type=i.MOUSE_MOVE,u.systemEvent.emit(e.type,e)},onMouseUp:function(e){e.type=i.MOUSE_UP,u.systemEvent.emit(e.type,e)},onMouseScroll:function(e){e.type=i.MOUSE_WHEEL,u.systemEvent.emit(e.type,e)}}),E.addListener(m,256)),t},t.off=function(n,t,r){if(e.prototype.off.call(this,n,t,r),_&&(n===i.KEY_DOWN||n===i.KEY_UP)){var s=this.hasEventListener(i.KEY_DOWN),l=this.hasEventListener(i.KEY_UP);s||l||(E.removeListener(_),_=null)}if(f&&n===i.DEVICEMOTION&&(E.removeListener(f),f=null),v&&(n===i.TOUCH_START||n===i.TOUCH_MOVE||n===i.TOUCH_END||n===i.TOUCH_CANCEL)){var u=this.hasEventListener(i.TOUCH_START),c=this.hasEventListener(i.TOUCH_MOVE),o=this.hasEventListener(i.TOUCH_END),a=this.hasEventListener(i.TOUCH_CANCEL);u||c||o||a||(E.removeListener(v),v=null)}if(m&&(n===i.MOUSE_DOWN||n===i.MOUSE_MOVE||n===i.MOUSE_UP||n===i.MOUSE_WHEEL)){var h=this.hasEventListener(i.MOUSE_DOWN),O=this.hasEventListener(i.MOUSE_MOVE),S=this.hasEventListener(i.MOUSE_UP),p=this.hasEventListener(i.MOUSE_WHEEL);h||O||S||p||(E.removeListener(m),m=null)}},n}(c));O.EventType=i,u.SystemEvent=O;var S=e("a",new O);u.systemEvent=S;var p=e("s",{_supportsFullScreen:!1,_onfullscreenchange:null,_onfullscreenerror:null,_preOnFullScreenError:null,_preOnTouch:null,_touchEvent:"",_fn:null,_fnMap:[["requestFullscreen","exitFullscreen","fullscreenchange","fullscreenEnabled","fullscreenElement"],["requestFullScreen","exitFullScreen","fullScreenchange","fullScreenEnabled","fullScreenElement"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitfullscreenchange","webkitIsFullScreen","webkitCurrentFullScreenElement"],["mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozFullScreen","mozFullScreenElement"],["msRequestFullscreen","msExitFullscreen","MSFullscreenChange","msFullscreenEnabled","msFullscreenElement"]],init:function(){var e,n,t;this._fn={};var r,s=this._fnMap;for(e=0,n=s.length;e<n;e++)if((t=s[e])&&void 0!==document[t[1]]){for(e=0,r=t.length;e<r;e++)this._fn[s[0][e]]=t[e];break}this._supportsFullScreen=void 0!==this._fn.requestFullscreen,this._touchEvent="ontouchstart"in window?"touchstart":"mousedown"},get supportsFullScreen(){return this._supportsFullScreen},fullScreen:function(){return!!this._supportsFullScreen&&void 0!==document[this._fn.fullscreenElement]&&null!==document[this._fn.fullscreenElement]},requestFullScreen:function(e,n,t){if(this._supportsFullScreen){if(e=e||document.documentElement,n){var r=this._fn.fullscreenchange;this._onfullscreenchange&&document.removeEventListener(r,this._onfullscreenchange),this._onfullscreenchange=n,document.addEventListener(r,n,!1)}if(t){var s=this._fn.fullscreenerror;this._onfullscreenerror&&document.removeEventListener(s,this._onfullscreenerror),this._onfullscreenerror=t,document.addEventListener(s,t,{once:!0})}var l=e[this._fn.requestFullscreen]();return window.Promise&&l instanceof Promise&&l.catch((function(){})),l}},exitFullScreen:function(){var e;return this.fullScreen()&&(e=document[this._fn.exitFullscreen]()).catch((function(){})),e},autoFullScreen:function(e,n){e=e||document.body,this._ensureFullScreen(e,n),this.requestFullScreen(e,n)},disableAutoFullScreen:function(e){if(this._preOnTouch){var n=u.game.canvas||e,t=this._touchEvent;n.removeEventListener(t,this._preOnTouch),this._preOnTouch=null}},_ensureFullScreen:function(e,n){var t=this,r=u.game.canvas||e,s=this._fn.fullscreenerror,l=this._touchEvent,c=function(){t._preOnFullScreenError=null,t._preOnTouch&&r.removeEventListener(l,t._preOnTouch),t._preOnTouch=function(){t._preOnTouch=null,t.requestFullScreen(e,n)},r.addEventListener(l,t._preOnTouch,{once:!0})};this._preOnFullScreenError&&e.removeEventListener(s,this._preOnFullScreenError),this._preOnFullScreenError=c,e.addEventListener(s,c,{once:!0})}});p.init(),u.screen=p}}}));
