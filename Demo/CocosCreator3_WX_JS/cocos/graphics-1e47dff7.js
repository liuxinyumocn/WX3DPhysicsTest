System.register(["./coordinates-converts-utils-bf8713a9.js","./index-6f89fc06.js","./event-enum-5a5aa40e.js","./renderable-component-658e90bd.js","./texture-buffer-pool-d3259f64.js","./json-asset-0797cbb7.js","./renderable-2d-386fc016.js","./vertex-format-dd7257e2.js"],(function(t){"use strict";var e,i,o,n,r,s,l,a,h,c,u,p,f,d,m,_,b,T,v,y,g,C,E,D,R,L,P,O,M,w,x,B,F,N,k,A;return{setters:[function(t){e=t.bE,i=t.e3,o=t.b0,n=t.bg,r=t.A,s=t.F,l=t.e2,a=t.ec,h=t.e4,c=t.e7,u=t.e8,p=t.e0,f=t.d,d=t.l,m=t.B,_=t.v,b=t.M,T=t.cD,v=t.e5,y=t.e9,g=t.e6,C=t.fs,E=t.fw,D=t.ft,R=t.fu,L=t.fm,P=t.ea},function(t){O=t.f},function(){},function(t){M=t.a},function(){},function(t){w=t.R},function(t){x=t.M,B=t.I,F=t.R},function(t){N=t.d,k=t.b,A=t.g}],execute:function(){var U,S,I;t({L:void 0,a:void 0,b:void 0}),function(t){t[t.BUTT=0]="BUTT",t[t.ROUND=1]="ROUND",t[t.SQUARE=2]="SQUARE"}(U||(U=t("a",{}))),e(U),function(t){t[t.BEVEL=0]="BEVEL",t[t.ROUND=1]="ROUND",t[t.MITER=2]="MITER"}(S||(S=t("L",{}))),e(S),function(t){t[t.PT_CORNER=1]="PT_CORNER",t[t.PT_LEFT=2]="PT_LEFT",t[t.PT_BEVEL=4]="PT_BEVEL",t[t.PT_INNERBEVEL=8]="PT_INNERBEVEL"}(I||(I=t("b",{}))),e(I);var z=Math.PI,j=Math.min,V=Math.max,W=Math.cos,J=Math.sin,X=Math.abs,Y=Math.sign,G=.5522847493;function q(t,e,i,o,n){t.moveTo(e-o,i),t.bezierCurveTo(e-o,i+n*G,e-o*G,i+n,e,i+n),t.bezierCurveTo(e+o*G,i+n,e+o,i+n*G,e+o,i),t.bezierCurveTo(e+o,i-n*G,e+o*G,i-n,e,i-n),t.bezierCurveTo(e-o*G,i-n,e-o,i-n*G,e-o,i),t.close()}var H,K,Q,Z,$,tt,et,it,ot,nt,rt,st,lt,at,ht,ct,ut,pt,ft,dt,mt,_t,bt,Tt,vt=t("P",function(t){function e(e,i){var o;return(o=t.call(this,e,i)||this).dx=0,o.dy=0,o.dmx=0,o.dmy=0,o.flags=0,o.len=0,o.reset(),o}return i(e,t),e.prototype.reset=function(){this.dx=0,this.dy=0,this.dmx=0,this.dmy=0,this.flags=0,this.len=0},e}(o)),yt=function(){function t(){this.closed=!1,this.bevel=0,this.complex=!0,this.points=[],this.reset()}return t.prototype.reset=function(){this.closed=!1,this.bevel=0,this.complex=!0,this.points?this.points.length=0:this.points=[]},t}(),gt=function(){function t(){this.dataOffset=0,this.updatePathOffset=!1,this.pathLength=0,this.pathOffset=0,this.paths=[],this.tessTol=.25,this.distTol=.01,this.fillColor=n.WHITE.clone(),this.lineCap=U.BUTT,this.strokeColor=n.BLACK.clone(),this.lineJoin=S.MITER,this.lineWidth=0,this.pointsOffset=0,this._commandX=0,this._commandY=0,this._points=[],this._renderDataList=[],this._curPath=null}var e=t.prototype;return e.moveTo=function(t,e){this.updatePathOffset&&(this.pathOffset=this.pathLength,this.updatePathOffset=!1),this._addPath(),this.addPoint(t,e,I.PT_CORNER),this._commandX=t,this._commandY=e},e.lineTo=function(t,e){this.addPoint(t,e,I.PT_CORNER),this._commandX=t,this._commandY=e},e.bezierCurveTo=function(t,e,i,o,n,r){var s=this._curPath,l=s.points[s.points.length-1];l&&(l.x!==t||l.y!==e||i!==n||o!==r?(function t(e,i,o,n,r,s,l,a,h,c,u){var p,f,d,m,_,b,T,v,y,g,C,E,D,R,L,P;c>10||(_=.5*(s+a),b=.5*(l+h),T=.5*((p=.5*(i+n))+(d=.5*(n+s))),v=.5*((f=.5*(o+r))+(m=.5*(r+l))),((L=X((n-a)*(R=h-o)-(r-h)*(D=a-i)))+(P=X((s-a)*R-(l-h)*D)))*(L+P)<e.tessTol*(D*D+R*R)?e.addPoint(a,h,0===u?u|I.PT_BEVEL:u):(t(e,i,o,p,f,T,v,C=.5*(T+(y=.5*(d+_))),E=.5*(v+(g=.5*(m+b))),c+1,0),t(e,C,E,y,g,_,b,a,h,c+1,u)))}(this,l.x,l.y,t,e,i,o,n,r,0,I.PT_CORNER),this._commandX=n,this._commandY=r):this.lineTo(n,r))},e.quadraticCurveTo=function(t,e,i,o){var n=this._commandX,r=this._commandY;this.bezierCurveTo(n+2/3*(t-n),r+2/3*(e-r),i+2/3*(t-i),o+2/3*(e-o),i,o)},e.arc=function(t,e,i,o,n,r){!function(t,e,i,o,n,r,s){var l,a,h=0,c=0,u=0,p=0,f=0,d=0,m=0,_=0,b=0,T=0,v=0,y=0,g=0,C=0;if(c=r-n,s=s||!1)if(X(c)>=2*z)c=2*z;else for(;c<0;)c+=2*z;else if(X(c)>=2*z)c=2*-z;else for(;c>0;)c-=2*z;for(a=0|V(1,j(X(c)/(.5*z)+.5,5)),u=X(4/3*(1-W(l=c/a/2))/J(l)),s||(u=-u),C=0;C<=a;C++)d=e+(p=W(h=n+c*(C/a)))*o,m=i+(f=J(h))*o,_=-f*o*u,b=p*o*u,0===C?t.moveTo(d,m):t.bezierCurveTo(T+y,v+g,d-_,m-b,d,m),T=d,v=m,y=_,g=b}(this,t,e,i,o,n,r)},e.ellipse=function(t,e,i,o){q(this,t,e,i,o),this._curPath.complex=!1},e.circle=function(t,e,i){q(this,t,e,i,i),this._curPath.complex=!1},e.rect=function(t,e,i,o){this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+o),this.lineTo(t,e+o),this.close(),this._curPath.complex=!1},e.roundRect=function(t,e,i,o,n){!function(t,e,i,o,n,r){if(r<.1)t.rect(e,i,o,n);else{var s=j(r,.5*X(o))*Y(o),l=j(r,.5*X(n))*Y(n);t.moveTo(e,i+l),t.lineTo(e,i+n-l),t.bezierCurveTo(e,i+n-l*(1-G),e+s*(1-G),i+n,e+s,i+n),t.lineTo(e+o-s,i+n),t.bezierCurveTo(e+o-s*(1-G),i+n,e+o,i+n-l*(1-G),e+o,i+n-l),t.lineTo(e+o,i+l),t.bezierCurveTo(e+o,i+l*(1-G),e+o-s*(1-G),i,e+o-s,i),t.lineTo(e+s,i),t.bezierCurveTo(e+s*(1-G),i,e,i+l*(1-G),e,i+l),t.close()}}(this,t,e,i,o,n),this._curPath.complex=!1},e.clear=function(){this.pathLength=0,this.pathOffset=0,this.pointsOffset=0,this.dataOffset=0,this._curPath=null,this.paths.length=0,this._points.length=0;for(var t=this._renderDataList,e=0,i=t.length;e<i;e++){var o=t[e];o&&x.remove(o)}this._renderDataList.length=0},e.close=function(){this._curPath.closed=!0},e.requestRenderData=function(){var t=x.add();return this._renderDataList.push(t),t},e.getRenderDataList=function(){return 0===this._renderDataList.length&&this.requestRenderData(),this._renderDataList},e.addPoint=function(t,e,i){var o=this._curPath;if(o){var n=this._points,r=o.points,s=n[this.pointsOffset++];s?(s.x=t,s.y=e):(s=new vt(t,e),n.push(s)),s.flags=i,r.push(s)}},e._addPath=function(){var t=this.pathLength,e=this.paths[t];return e?e.reset():(e=new yt,this.paths.push(e)),this.pathLength++,this._curPath=e,e},t}(),Ct=N.concat([new r("a_dist",s.R32F)]),Et=k(Ct),Dt=A(Ct);t("G",(H=l("cc.Graphics"),K=C(),Q=E(110),Z=D(),$=a(S),tt=R(),et=a(U),it=R(),ot=R(),nt=R(),rt=R(),st=L(),lt=L(),at=L(),H(ht=K(ht=Q(ht=Z((Tt=bt=function(t){function e(){var e;return(e=t.call(this)||this).impl=null,e.model=null,c(e,"_lineWidth",ut,u(e)),c(e,"_strokeColor",pt,u(e)),c(e,"_lineJoin",ft,u(e)),c(e,"_lineCap",dt,u(e)),c(e,"_fillColor",mt,u(e)),c(e,"_miterLimit",_t,u(e)),e._isDrawing=!1,e._isNeedUploadData=!0,e._instanceMaterialType=B.ADD_COLOR,e.impl=new gt,e}i(e,t),h(e,[{key:"lineWidth",get:function(){return this._lineWidth},set:function(t){this._lineWidth=t,this.impl&&(this.impl.lineWidth=t)}},{key:"lineJoin",get:function(){return this._lineJoin},set:function(t){this._lineJoin=t,this.impl&&(this.impl.lineJoin=t)}},{key:"lineCap",get:function(){return this._lineCap},set:function(t){this._lineCap=t,this.impl&&(this.impl.lineCap=t)}},{key:"strokeColor",get:function(){return this._strokeColor},set:function(t){this.impl&&(this._strokeColor.set(t),this.impl.strokeColor=this._strokeColor)}},{key:"fillColor",get:function(){return this._fillColor},set:function(t){this.impl&&(this._fillColor.set(t),this.impl.fillColor=this._fillColor)}},{key:"miterLimit",get:function(){return this._miterLimit},set:function(t){this._miterLimit=t}},{key:"color",get:function(){return this._color},set:function(t){this._color!==t&&(this._color.set(t),this._updateColor(),this.markForUpdateRenderData())}},{key:"srcBlendFactor",get:function(){return this._srcBlendFactor},set:function(){}},{key:"dstBlendFactor",get:function(){return this._dstBlendFactor},set:function(){}}]);var o=e.prototype;return o.onRestore=function(){this.impl||this._flushAssembler()},o.onLoad=function(){this.model=O.root.createModel(M),this.model.node=this.model.transform=this.node,this._flushAssembler()},o.onEnable=function(){t.prototype.onEnable.call(this),this._updateMtlForGraphics()},o.onDisable=function(){t.prototype.onDisable.call(this)},o.onDestroy=function(){t.prototype.onDestroy.call(this),this._sceneGetter=null,this.model&&(O.root.destroyModel(this.model),this.model=null),this.impl&&(this._isDrawing=!1,this.impl.clear(),this.impl=null)},o.moveTo=function(t,e){this.impl&&this.impl.moveTo(t,e)},o.lineTo=function(t,e){this.impl&&this.impl.lineTo(t,e)},o.bezierCurveTo=function(t,e,i,o,n,r){this.impl&&this.impl.bezierCurveTo(t,e,i,o,n,r)},o.quadraticCurveTo=function(t,e,i,o){this.impl&&this.impl.quadraticCurveTo(t,e,i,o)},o.arc=function(t,e,i,o,n,r){this.impl&&this.impl.arc(t,e,i,o,n,r)},o.ellipse=function(t,e,i,o){this.impl&&this.impl.ellipse(t,e,i,o)},o.circle=function(t,e,i){this.impl&&this.impl.circle(t,e,i)},o.rect=function(t,e,i,o){this.impl&&this.impl.rect(t,e,i,o)},o.roundRect=function(t,e,i,o,n){this.impl&&this.impl.roundRect(t,e,i,o,n)},o.fillRect=function(t,e,i,o){this.rect(t,e,i,o),this.fill()},o.clear=function(){if(this.impl){if(this.impl.clear(),this._isDrawing=!1,this.model)for(var t=0;t<this.model.subModels.length;t++)this.model.subModels[t].inputAssembler.indexCount=0;this.markForUpdateRenderData()}},o.close=function(){this.impl&&this.impl.close()},o.stroke=function(){this._assembler||this._flushAssembler(),this._isDrawing=!0,this._isNeedUploadData=!0,this._assembler.stroke(this)},o.fill=function(){this._assembler||this._flushAssembler(),this._isDrawing=!0,this._isNeedUploadData=!0,this._assembler.fill(this)},o._updateMtlForGraphics=function(){var t;this._customMaterial?t=this.getMaterialInstance(0):(t=p.get("ui-graphics-material"),this.setMaterial(t,0),(t=this.getMaterialInstance(0)).recompileShaders({USE_LOCAL:!0}))},o.activeSubModel=function(t){if(this.model){if(this.model.subModels.length<=t){var e=d.director.root.device,i=e.createBuffer(new m(_.VERTEX|_.TRANSFER_DST,b.DEVICE,65535*Dt,Dt)),o=e.createBuffer(new m(_.INDEX|_.TRANSFER_DST,b.DEVICE,131070*Uint16Array.BYTES_PER_ELEMENT,Uint16Array.BYTES_PER_ELEMENT)),n=new w([i],Ct,T.TRIANGLE_LIST,o);n.subMeshIdx=0,this.model.initSubModel(t,n,this.getMaterialInstance(0))}}else f(4500,this.node.name)},o._uploadData=function(t){var e=this.impl;if(e){var i=e&&e.getRenderDataList();if(!(i.length<=0)&&this.model){for(var o=this.model.subModels,n=0;n<i.length;n++){var r=i[n],s=o[n].inputAssembler;if(r.lastFilledVertex!==r.vertexStart){var l=new Float32Array(r.vData.buffer,0,r.vertexStart*Et);s.vertexBuffers[0].update(l),s.vertexCount=r.vertexStart;var a=new Uint16Array(r.iData.buffer,0,r.indicesStart);s.indexBuffer.update(a),s.indexCount=r.indicesStart,r.lastFilledVertex=r.vertexStart,r.lastFilledIndices=r.indicesStart}}t.removeUploadBuffersFunc(this),this._isNeedUploadData=!1}}},o._render=function(t){if(this._isNeedUploadData){if(this.impl){var e=this.impl.getRenderDataList(),i=this.model.subModels.length;if(e.length>i)for(var o=i;o<e.length;o++)this.activeSubModel(o)}t.addUploadBuffersFunc(this,this._uploadData)}t.commitModel(this,this.model,this.getMaterialInstance(0))},o._flushAssembler=function(){var t=e.Assembler.getAssembler(this);this._assembler!==t&&(this._assembler=t)},o._canRender=function(){return!!t.prototype._canRender.call(this)&&!!this.model&&this._isDrawing},e}(F),bt.LineJoin=S,bt.LineCap=U,v((ct=Tt).prototype,"lineWidth",[y],Object.getOwnPropertyDescriptor(ct.prototype,"lineWidth"),ct.prototype),v(ct.prototype,"lineJoin",[$,tt],Object.getOwnPropertyDescriptor(ct.prototype,"lineJoin"),ct.prototype),v(ct.prototype,"lineCap",[et,it],Object.getOwnPropertyDescriptor(ct.prototype,"lineCap"),ct.prototype),v(ct.prototype,"strokeColor",[ot],Object.getOwnPropertyDescriptor(ct.prototype,"strokeColor"),ct.prototype),v(ct.prototype,"fillColor",[nt],Object.getOwnPropertyDescriptor(ct.prototype,"fillColor"),ct.prototype),v(ct.prototype,"miterLimit",[rt],Object.getOwnPropertyDescriptor(ct.prototype,"miterLimit"),ct.prototype),v(ct.prototype,"color",[g,st],Object.getOwnPropertyDescriptor(ct.prototype,"color"),ct.prototype),v(ct.prototype,"srcBlendFactor",[g,lt],Object.getOwnPropertyDescriptor(ct.prototype,"srcBlendFactor"),ct.prototype),v(ct.prototype,"dstBlendFactor",[g,at],Object.getOwnPropertyDescriptor(ct.prototype,"dstBlendFactor"),ct.prototype),ut=v(ct.prototype,"_lineWidth",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),pt=v(ct.prototype,"_strokeColor",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return n.BLACK.clone()}}),ft=v(ct.prototype,"_lineJoin",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return S.MITER}}),dt=v(ct.prototype,"_lineCap",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return U.BUTT}}),mt=v(ct.prototype,"_fillColor",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return n.WHITE.clone()}}),_t=v(ct.prototype,"_miterLimit",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),ht=ct))||ht)||ht)||ht)||ht))}}}));
