System.register(["./coordinates-converts-utils-bf8713a9.js","./json-asset-0797cbb7.js"],(function(t){"use strict";var e,i,n,r;return{setters:[function(t){e=t.e2,i=t.e3,n=t.e4,r=t.c5},function(){}],execute:function(){t("k",4),t("h",4),t("i",256);var s,h=t("b",32),a=(t("a",33),t("c",8),t("f",32768)),f=t("g",1/512),o=(t("e",-a*f),t("d",(65535-a)*f),t("l",0),t("m",1),t("n",2),t("o",3),t("p",16842753)),l=t("q",16842754),u=t("r",16842755),g=t("s",16842756),c=t("t",16843025),w=function(){function t(){this.length=0,this.buffer=new Uint8Array(2048),this._buffView=new DataView(this.buffer.buffer),this._seekPos=0}var e=t.prototype;return e.reserve=function(t){if(!(this.buffer.byteLength>t)){for(var e=this.buffer.byteLength;e<t;)e+=e;for(var i=new Uint8Array(e),n=0;n<this.length;++n)i[n]=this.buffer[n];this.buffer=i,this._buffView=new DataView(this.buffer.buffer)}},e.assign=function(t){this.buffer=t,this.length=t.length,this._seekPos=t.byteOffset,this._buffView=new DataView(t.buffer)},e.writeInt8=function(t){this.reserve(this.length+1),this._buffView.setInt8(this.length,t),this.length+=1},e.writeInt16=function(t){this.reserve(this.length+2),this._buffView.setInt16(this.length,t,!0),this.length+=2},e.writeInt32=function(t){this.reserve(this.length+4),this._buffView.setInt32(this.length,t,!0),this.length+=4},e.writeIntArray=function(t){this.reserve(this.length+4*t.length);for(var e=0;e<t.length;++e)this._buffView.setInt32(this.length+4*e,t[e],!0);this.length+=4*t.length},e.writeFloat=function(t){this.reserve(this.length+4),this._buffView.setFloat32(this.length,t,!0),this.length+=4},e.writeFloatArray=function(t){this.reserve(this.length+4*t.length);for(var e=0;e<t.length;++e)this._buffView.setFloat32(this.length+4*e,t[e],!0);this.length+=4*t.length},e.writeString=function(t){this.reserve(this.length+t.length+4),this._buffView.setInt32(this.length,t.length,!0);for(var e=0;e<t.length;++e)this._buffView.setInt8(this.length+4+e,t.charCodeAt(e));this.length+=t.length+4},e.readInt8=function(){var t=this._buffView.getInt8(this._seekPos);return this._seekPos+=1,t},e.readInt16=function(){var t=this._buffView.getInt16(this._seekPos,!0);return this._seekPos+=2,t},e.readInt=function(){var t=this._buffView.getInt32(this._seekPos,!0);return this._seekPos+=4,t},e.readIntArray=function(t){for(var e=0;e<t.length;++e)t[e]=this._buffView.getInt32(this._seekPos+4*e,!0);return this._seekPos+=4*t.length,t},e.readFloat=function(){var t=this._buffView.getFloat32(this._seekPos,!0);return this._seekPos+=4,t},e.readFloatArray=function(t){for(var e=0;e<t.length;++e)t[e]=this._buffView.getFloat32(this._seekPos+4*e,!0);return this._seekPos+=4*t.length,t},e.readString=function(){for(var t=this.readInt(),e="",i=0;i<t;++i)e+=String.fromCharCode(this.readInt8());return e},t}(),_=t("j",(function(){this.slot=0,this.tileSize=1,this.detailMap="",this.normalMap="",this.roughness=1,this.metallic=0}));t("T",e("cc.TerrainAsset")(s=function(t){function e(){var e;return(e=t.call(this)||this)._data=null,e._tileSize=1,e._blockCount=[1,1],e._weightMapSize=128,e._lightMapSize=128,e._heights=new Uint16Array,e._weights=new Uint8Array,e._layerBuffer=[-1,-1,-1,-1],e._layerInfos=[],e.loaded=!1,e}i(e,t);var r=e.prototype;return r.getLayer=function(t,e,i){var n=4*(e*this.blockCount[0]+t)+i;return t<this.blockCount[0]&&e<this.blockCount[1]&&n<this._layerBuffer.length?this._layerBuffer[n]:-1},r.getHeight=function(t,e){var i=this._blockCount[0]*h+1;return(this._heights[e*i+t]-a)*f},r.getVertexCountI=function(){return this._blockCount.length<1?0:this._blockCount[0]*h+1},r.getVertexCountJ=function(){return this._blockCount.length<2?0:this._blockCount[1]*h+1},r._setNativeData=function(t){this._data=t},r._loadNativeData=function(t){var e=new w;e.assign(t);var i=e.readInt();if(i===c)return!0;if(i!==o&&i!==l&&i!==u&&i!==g)return!1;this.tileSize=e.readFloat(),e.readIntArray(this._blockCount),this.weightMapSize=e.readInt16(),this.lightMapSize=e.readInt16();var n=e.readInt();this.heights=new Uint16Array(n);for(var r=0;r<this.heights.length;++r)this.heights[r]=e.readInt16();var s=e.readInt();this.weights=new Uint8Array(s);for(var h=0;h<this.weights.length;++h)this.weights[h]=e.readInt8();if(i>=l){var a=e.readInt();this.layerBuffer=new Array(a);for(var f=0;f<this.layerBuffer.length;++f)this.layerBuffer[f]=e.readInt16()}if(i>=u){var y=e.readInt();this.layerInfos=new Array(y);for(var I=0;I<this.layerInfos.length;++I)this.layerInfos[I]=new _,this.layerInfos[I].slot=e.readInt(),this.layerInfos[I].tileSize=e.readFloat(),this.layerInfos[I].detailMap=e.readString(),i>=g&&(this.layerInfos[I].normalMap=e.readString(),this.layerInfos[I].roughness=e.readFloat(),this.layerInfos[I].metallic=e.readFloat())}return!0},r._exportNativeData=function(){var t=new w;t.writeInt32(g),t.writeFloat(this.tileSize),t.writeIntArray(this._blockCount),t.writeInt16(this.weightMapSize),t.writeInt16(this.lightMapSize),t.writeInt32(this.heights.length);for(var e=0;e<this.heights.length;++e)t.writeInt16(this.heights[e]);t.writeInt32(this.weights.length);for(var i=0;i<this.weights.length;++i)t.writeInt8(this.weights[i]);t.writeInt32(this.layerBuffer.length);for(var n=0;n<this.layerBuffer.length;++n)t.writeInt16(this.layerBuffer[n]);t.writeInt32(this.layerInfos.length);for(var r=0;r<this.layerInfos.length;++r)t.writeInt32(this.layerInfos[r].slot),t.writeFloat(this.layerInfos[r].tileSize),t.writeString(this.layerInfos[r].detailMap),t.writeString(this.layerInfos[r].normalMap),t.writeFloat(this.layerInfos[r].roughness),t.writeFloat(this.layerInfos[r].metallic);return t.buffer},r._exportDefaultNativeData=function(){var t=new w;return t.writeInt32(c),t.buffer},n(e,[{key:"_nativeAsset",get:function(){return this._data.buffer},set:function(t){this._data&&this._data.byteLength===t.byteLength?this._data.set(new Uint8Array(t)):this._data=new Uint8Array(t),this._loadNativeData(this._data),this.loaded=!0,this.emit("load")}},{key:"tileSize",set:function(t){this._tileSize=t},get:function(){return this._tileSize}},{key:"blockCount",set:function(t){this._blockCount=t},get:function(){return this._blockCount}},{key:"lightMapSize",set:function(t){this._lightMapSize=t},get:function(){return this._lightMapSize}},{key:"weightMapSize",set:function(t){this._weightMapSize=t},get:function(){return this._weightMapSize}},{key:"heights",set:function(t){this._heights=t},get:function(){return this._heights}},{key:"weights",set:function(t){this._weights=t},get:function(){return this._weights}},{key:"layerBuffer",set:function(t){this._layerBuffer=t},get:function(){return this._layerBuffer}},{key:"layerInfos",set:function(t){this._layerInfos=t},get:function(){return this._layerInfos}}]),e}(r))||s)}}}));
