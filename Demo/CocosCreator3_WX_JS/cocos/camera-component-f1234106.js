System.register(["./coordinates-converts-utils-bf8713a9.js","./event-enum-5a5aa40e.js","./deprecated-3.0.0-f3f53c89.js","./renderable-component-658e90bd.js","./view-7d20208a.js"],(function(t){"use strict";var e,r,o,i,n,s,a,c,u,p,h,l,_,f,g,y,b,m,d,v,w,T,O,E,S,C,k,I,P,L,z,D,j,A,N,x,R,F,U,H,M,B,W,Y,G,V,Z,X,q,K,Q,$,J,tt,et,rt,ot,it,nt,st,at,ct,ut,pt,ht,lt,_t,ft;return{setters:[function(t){e=t.b0,r=t.e4,o=t.fk,i=t.l,n=t.f,s=t.bL,a=t.bc,c=t.bM,u=t.dY,p=t.b2,h=t.b6,l=t.e2,_=t.ec,f=t.b_,g=t.e5,y=t.e9,b=t.c9,m=t.fl,d=t.b$,v=t.bZ,w=t.e7,T=t.bg,O=t.ea,E=t.fm,S=t.fn,C=t.fo,k=t.eb,I=t.fp,P=t.e3,L=t.e8,z=t.b9,D=t.bU,j=t.ci,A=t.fi,N=t.ep,x=t.eB,R=t.f3,F=t.fq,U=t.t,H=t.bV,M=t.bD,B=t.d0,W=t.cc,Y=t.fr,G=t.bo,V=t.fs,Z=t.ft,X=t.fu,q=t.d_,K=t.be,Q=t.ev},function(t){$=t.q,J=t.l,tt=t.h,et=t.P,rt=t.A,ot=t.a,it=t.C,nt=t.b,st=t.d,at=t.c,ct=t.S,ut=t.T},function(t){pt=t.R},function(t){ht=t.N,lt=t.B},function(t){_t=t.h,ft=t.v}],execute:function(){var gt=new Array(16),yt=null,bt=new e,mt=[$.TOUCH_START.toString(),$.TOUCH_MOVE.toString(),$.TOUCH_END.toString(),$.TOUCH_CANCEL.toString()],dt=[$.MOUSE_DOWN.toString(),$.MOUSE_ENTER.toString(),$.MOUSE_MOVE.toString(),$.MOUSE_LEAVE.toString(),$.MOUSE_UP.toString(),$.MOUSE_WHEEL.toString()];function vt(t,e){var r=this.owner;return!(!r||!r._uiProps.uiTransformComp||(t.getUILocation(bt),!r._uiProps.uiTransformComp.isHit(bt,this)||(e.type=$.TOUCH_START.toString(),e.touch=t,e.bubbles=!0,r.dispatchEvent(e),0)))}function wt(t,e){var r=this.owner;return!(!r||!r._uiProps.uiTransformComp||(e.type=$.TOUCH_MOVE.toString(),e.touch=t,e.bubbles=!0,r.dispatchEvent(e),0))}function Tt(t,e){var r=this.owner;r&&r._uiProps.uiTransformComp&&(t.getUILocation(bt),r._uiProps.uiTransformComp.isHit(bt,this)?e.type=$.TOUCH_END.toString():e.type=$.TOUCH_CANCEL.toString(),e.touch=t,e.bubbles=!0,r.dispatchEvent(e))}function Ot(t,e){var r=this.owner;r&&r._uiProps.uiTransformComp&&(e.type=$.TOUCH_CANCEL.toString(),e.touch=t,e.bubbles=!0,r.dispatchEvent(e))}function Et(t){var e=this.owner;e&&e._uiProps.uiTransformComp&&(bt=t.getUILocation(),e._uiProps.uiTransformComp.isHit(bt,this)&&(t.type=$.MOUSE_DOWN.toString(),t.bubbles=!0,e.dispatchEvent(t)))}function St(t){var e=this.owner;if(e&&e._uiProps.uiTransformComp){if(bt=t.getUILocation(),e._uiProps.uiTransformComp.isHit(bt,this))this._previousIn||(yt&&yt.eventProcessor.mouseListener&&(t.type=$.MOUSE_LEAVE,yt.dispatchEvent(t),yt.eventProcessor.mouseListener&&(yt.eventProcessor.mouseListener._previousIn=!1)),yt=e,t.type=$.MOUSE_ENTER.toString(),e.dispatchEvent(t),this._previousIn=!0),t.type=$.MOUSE_MOVE.toString(),t.bubbles=!0,e.dispatchEvent(t);else{if(!this._previousIn)return;t.type=$.MOUSE_LEAVE.toString(),e.dispatchEvent(t),this._previousIn=!1,yt=null}t.propagationStopped=!0}}function Ct(t){var e=this.owner;e&&e._uiProps.uiTransformComp&&(bt=t.getUILocation(),e._uiProps.uiTransformComp.isHit(bt,this)&&(t.type=$.MOUSE_UP.toString(),t.bubbles=!0,e.dispatchEvent(t),t.propagationStopped=!0))}function kt(t){var e=this.owner;e&&e._uiProps.uiTransformComp&&(bt=t.getUILocation(),e._uiProps.uiTransformComp.isHit(bt,this)&&(t.type=$.MOUSE_WHEEL.toString(),t.bubbles=!0,e.dispatchEvent(t),t.propagationStopped=!0))}function It(t,e){if(e){for(var r=0,o=[],i=t;i&&ht.isNode(i);i=i.parent,++r){var n=i.getComponent(e);if(n){var s={index:r,comp:n};o?o.push(s):o=[s]}}return o.length>0?o:null}return null}function Pt(t,e){if(!t._persistNode){if(t.eventProcessor.bubblingTargets)for(var r=0;r<e.length;++r)if(t.eventProcessor.bubblingTargets.hasEventListener(e[r]))return!0;if(t.eventProcessor.capturingTargets)for(var o=0;o<e.length;++o)if(t.eventProcessor.capturingTargets.hasEventListener(e[o]))return!0;return!1}return!0}var Lt,zt,Dt,jt,At,Nt,xt,Rt,Ft,Ut,Ht,Mt,Bt,Wt,Yt,Gt,Vt,Zt,Xt,qt,Kt,Qt,$t,Jt,te,ee,re,oe,ie,ne,se,ae,ce,ue,pe,he,le,_e,fe,ge,ye,be,me,de,ve,we,Te,Oe,Ee,Se,Ce,ke,Ie,Pe,Le,ze,De,je,Ae,Ne,xe,Re,Fe,Ue,He,Me,Be,We,Ye,Ge,Ve,Ze,Xe,qe,Ke,Qe,$e,Je,tr,er,rr,or,ir,nr,sr,ar,cr,ur,pr,hr,lr,_r,fr,gr,yr,br,mr,dr,vr,wr,Tr,Or,Er,Sr,Cr,kr,Ir,Pr=function(){function t(t){this.bubblingTargets=null,this.capturingTargets=null,this.touchListener=null,this.mouseListener=null,this._node=void 0,this._comp=null,this._node=t}r(t,[{key:"node",get:function(){return this._node}}]);var e=t.prototype;return e.reattach=function(){if(this._comp)if(this.touchListener){var t=this.touchListener.mask=It(this._node,this._comp);this.mouseListener&&(this.mouseListener.mask=t)}else this.mouseListener&&(this.mouseListener.mask=It(this._node,this._comp))},e.registerComponentHitList=function(t){this._comp=t},e.destroy=function(){yt===this._node&&(yt=null),(this.touchListener||this.mouseListener)&&(J.removeListeners(this._node),this.touchListener&&(this.touchListener.owner=null,this.touchListener.mask=null,this.touchListener=null),this.mouseListener&&(this.mouseListener.owner=null,this.mouseListener.mask=null,this.mouseListener=null)),this.capturingTargets&&this.capturingTargets.clear(),this.bubblingTargets&&this.bubblingTargets.clear()},e.on=function(t,e,r,i){return this._checknSetupSysEvent(t)?this._onDispatch(t,e,r,i):(this.bubblingTargets||(this.bubblingTargets=new o),this.bubblingTargets.on(t,e,r))},e.once=function(t,e,r,i){var n,s=this;(n=this._checknSetupSysEvent(t)&&i?this.capturingTargets=this.capturingTargets||new o:this.bubblingTargets=this.bubblingTargets||new o).on(t,e,r,!0),n.on(t,(function(){s.off(t,e,r)}),void 0,!0)},e.off=function(t,e,r,o){var i=-1!==mt.indexOf(t),n=!i&&-1!==dt.indexOf(t);i||n?(this._offDispatch(t,e,r,o),i?this.touchListener&&!Pt(this._node,mt)&&(J.removeListener(this.touchListener),this.touchListener=null):n&&this.mouseListener&&!Pt(this._node,dt)&&(J.removeListener(this.mouseListener),this.mouseListener=null)):this.bubblingTargets&&this.bubblingTargets.off(t,e,r)},e.emit=function(t,e,r,o,i,n){this.bubblingTargets&&this.bubblingTargets.emit(t,e,r,o,i,n)},e.dispatchEvent=function(t){!function(t,e){var r,o=0;for(e.target=t,gt.length=0,t.eventProcessor.getCapturingTargets(e.type,gt),e.eventPhase=1,o=gt.length-1;o>=0;--o)if((r=gt[o]).eventProcessor.capturingTargets&&(e.currentTarget=r,r.eventProcessor.capturingTargets.emit(e.type,e,gt),e.propagationStopped))return void(gt.length=0);if(gt.length=0,e.eventPhase=2,e.currentTarget=t,t.eventProcessor.capturingTargets&&t.eventProcessor.capturingTargets.emit(e.type,e),!e.propagationImmediateStopped&&t.eventProcessor.bubblingTargets&&t.eventProcessor.bubblingTargets.emit(e.type,e),!e.propagationStopped&&e.bubbles)for(t.eventProcessor.getBubblingTargets(e.type,gt),e.eventPhase=3,o=0;o<gt.length;++o)if((r=gt[o]).eventProcessor.bubblingTargets&&(e.currentTarget=r,r.eventProcessor.bubblingTargets.emit(e.type,e),e.propagationStopped))return void(gt.length=0);gt.length=0}(this._node,t),gt.length=0},e.hasEventListener=function(t,e,r){var o=!1;return this.bubblingTargets&&(o=this.bubblingTargets.hasEventListener(t,e,r)),!o&&this.capturingTargets&&(o=this.capturingTargets.hasEventListener(t,e,r)),o},e.targetOff=function(t){this.capturingTargets&&this.capturingTargets.removeAll(t),this.bubblingTargets&&this.bubblingTargets.removeAll(t),this.touchListener&&!Pt(this.node,mt)&&(J.removeListener(this.touchListener),this.touchListener=null),this.mouseListener&&!Pt(this.node,dt)&&(J.removeListener(this.mouseListener),this.mouseListener=null)},e.getCapturingTargets=function(t,e){for(var r=this._node.parent;r;)r.eventProcessor.capturingTargets&&r.eventProcessor.capturingTargets.hasEventListener(t)&&e.push(r),r=r.parent},e.getBubblingTargets=function(t,e){for(var r=this._node.parent;r;)r.eventProcessor.bubblingTargets&&r.eventProcessor.bubblingTargets.hasEventListener(t)&&e.push(r),r=r.parent},e._checknSetupSysEvent=function(t){var e=this,r=!1,o=!1;return-1!==mt.indexOf(t)?(this.touchListener||(this.touchListener=i.EventListener.create({event:i.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,owner:this._node,mask:It(this._node,this._comp),onTouchBegan:vt,onTouchMoved:wt,onTouchEnded:Tt,onTouchCancelled:Ot}),J.addListener(this.touchListener,this._node),r=!0),o=!0):-1!==dt.indexOf(t)&&(this.mouseListener||(this.mouseListener=i.EventListener.create({event:i.EventListener.MOUSE,_previousIn:!1,owner:this._node,mask:It(this._node,this._comp),onMouseDown:Et,onMouseMove:St,onMouseUp:Ct,onMouseScroll:kt}),J.addListener(this.mouseListener,this._node),r=!0),o=!0),r&&!this._node.activeInHierarchy&&i.director.getScheduler().schedule((function(){e._node.activeInHierarchy||J.pauseTarget(e._node)}),this._node,0,0,0,!1),o},e._onDispatch=function(t,e,r,i){if("boolean"==typeof r?(i=r,r=void 0):i=!!i,e){var s=null;return(s=i?this.capturingTargets=this.capturingTargets||new o:this.bubblingTargets=this.bubblingTargets||new o).hasEventListener(t,e,r)||s.on(t,e,r),e}n(6800)},e._offDispatch=function(t,e,r,o){if("boolean"==typeof r?(o=r,r=void 0):o=!!o,e){var i=o?this.capturingTargets:this.bubblingTargets;i&&i.off(t,e,r)}else this.capturingTargets&&this.capturingTargets.removeAll(t),this.bubblingTargets&&this.bubblingTargets.removeAll(t)},t}();i.NodeEventProcessor=Pr,s(lt.prototype,"BaseNode",[{name:"childrenCount",newName:"children.length",customGetter:function(){return this.children.length}}]),s(ht.prototype,"Node",[{name:"width",targetName:"node.getComponent(UITransform)",customGetter:function(){return this._uiProps.uiTransformComp.width},customSetter:function(t){this._uiProps.uiTransformComp.width=t}},{name:"height",targetName:"node.getComponent(UITransform)",customGetter:function(){return this._uiProps.uiTransformComp.height},customSetter:function(t){this._uiProps.uiTransformComp.height=t}},{name:"anchorX",targetName:"node.getComponent(UITransform)",customGetter:function(){return this._uiProps.uiTransformComp.anchorX},customSetter:function(t){this._uiProps.uiTransformComp.anchorX=t}},{name:"anchorY",targetName:"node.getComponent(UITransform)",customGetter:function(){return this._uiProps.uiTransformComp.anchorY},customSetter:function(t){this._uiProps.uiTransformComp.anchorY=t}},{name:"getAnchorPoint",targetName:"node.getComponent(UITransform)",customFunction:function(t){return t||(t=new e),t.set(this._uiProps.uiTransformComp.anchorPoint),t}},{name:"setAnchorPoint",targetName:"node.getComponent(UITransform)",customFunction:function(t,e){this._uiProps.uiTransformComp.setAnchorPoint(t,e)}},{name:"getContentSize",targetName:"node.getComponent(UITransform)",customFunction:function(t){return t||(t=new a),t.set(this._uiProps.uiTransformComp.contentSize),t}},{name:"setContentSize",targetName:"node.getComponent(UITransform)",customFunction:function(t,e){"number"==typeof t?this._uiProps.uiTransformComp.setContentSize(t,e):this._uiProps.uiTransformComp.setContentSize(t)}}]),c(ht.prototype,"Node.prototype",[{name:"addLayer"},{name:"removeLayer"}]),c(u,"Layers",[{name:"All"},{name:"RaycastMask"},{name:"check"}]),s(u,"Layers",[{name:"Default",newName:"DEFAULT",target:u.Enum,targetName:"Layers.Enum"},{name:"Always",newName:"ALWAYS",target:u.Enum,targetName:"Layers.Enum"},{name:"IgnoreRaycast",newName:"IGNORE_RAYCAST",target:u.Enum,targetName:"Layers.Enum"},{name:"Gizmos",newName:"GIZMOS",target:u.Enum,targetName:"Layers.Enum"},{name:"Editor",newName:"EDITOR",target:u.Enum,targetName:"Layers.Enum"},{name:"UI",newName:"UI_3D",target:u.Enum,targetName:"Layers.Enum"},{name:"UI2D",newName:"UI_2D",target:u.Enum,targetName:"Layers.Enum"},{name:"SceneGizmo",newName:"SCENE_GIZMO",target:u.Enum,targetName:"Layers.Enum"},{name:"makeInclusiveMask",newName:"makeMaskInclude",target:u,targetName:"Layers"},{name:"makeExclusiveMask",newName:"makeMaskExclude",target:u,targetName:"Layers"}]),c(u.Enum,"Layers.Enum",[{name:"ALWAYS"}]),c(u.BitMask,"Layers.BitMask",[{name:"ALWAYS"}]);var Lr=new p(0,1,0),zr=new p,Dr=new h,jr=(Lt=l("cc.AmbientInfo"),zt=_(f),Lt((Rt=function(){function t(){w(this,"_skyColor",At,this),w(this,"_skyIllum",Nt,this),w(this,"_groundAlbedo",xt,this),this._resource=null}return t.prototype.activate=function(t){this._resource=t,this._resource.initialize(this)},r(t,[{key:"skyColor",set:function(t){this._skyColor.set(t),this._resource&&(this._resource.skyColor=this._skyColor)},get:function(){return this._skyColor}},{key:"skyIllum",set:function(t){this._skyIllum=t,this._resource&&(this._resource.skyIllum=this.skyIllum)},get:function(){return this._skyIllum}},{key:"groundAlbedo",set:function(t){this._groundAlbedo.set(t),this._resource&&(this._resource.groundAlbedo=this._groundAlbedo)},get:function(){return this._groundAlbedo}}]),t}(),At=g((jt=Rt).prototype,"_skyColor",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new T(51,128,204,1)}}),Nt=g(jt.prototype,"_skyIllum",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return rt.SKY_ILLUM}}),xt=g(jt.prototype,"_groundAlbedo",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new T(51,51,51,255)}}),g(jt.prototype,"skyColor",[y],Object.getOwnPropertyDescriptor(jt.prototype,"skyColor"),jt.prototype),g(jt.prototype,"skyIllum",[y,zt],Object.getOwnPropertyDescriptor(jt.prototype,"skyIllum"),jt.prototype),g(jt.prototype,"groundAlbedo",[y],Object.getOwnPropertyDescriptor(jt.prototype,"groundAlbedo"),jt.prototype),Dt=jt))||Dt);i.AmbientInfo=jr;var Ar=(Ft=l("cc.SkyboxInfo"),Ut=_(b),Ht=_(b),Ft((Zt=function(){function t(){w(this,"_envmap",Wt,this),w(this,"_isRGBE",Yt,this),w(this,"_enabled",Gt,this),w(this,"_useIBL",Vt,this),this._resource=null}return t.prototype.activate=function(t){this._resource=t,this._resource.initialize(this),this._resource.activate()},r(t,[{key:"enabled",set:function(t){this._enabled!==t&&(this._enabled=t,this._resource&&(this._resource.enabled=this._enabled))},get:function(){return this._enabled}},{key:"useIBL",set:function(t){this._useIBL=t,this._resource&&(this._resource.useIBL=this._useIBL)},get:function(){return this._useIBL}},{key:"envmap",set:function(t){this._envmap=t,this._resource&&(this._resource.envmap=this._envmap)},get:function(){return this._envmap}},{key:"isRGBE",set:function(t){this._isRGBE=t,this._resource&&(this._resource.isRGBE=this._isRGBE)},get:function(){return this._isRGBE}}]),t}(),Wt=g((Bt=Zt).prototype,"_envmap",[Ut],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Yt=g(Bt.prototype,"_isRGBE",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Gt=g(Bt.prototype,"_enabled",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Vt=g(Bt.prototype,"_useIBL",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),g(Bt.prototype,"enabled",[y],Object.getOwnPropertyDescriptor(Bt.prototype,"enabled"),Bt.prototype),g(Bt.prototype,"useIBL",[y],Object.getOwnPropertyDescriptor(Bt.prototype,"useIBL"),Bt.prototype),g(Bt.prototype,"envmap",[y,Ht],Object.getOwnPropertyDescriptor(Bt.prototype,"envmap"),Bt.prototype),g(Bt.prototype,"isRGBE",[y],Object.getOwnPropertyDescriptor(Bt.prototype,"isRGBE"),Bt.prototype),Mt=Bt))||Mt);i.SkyboxInfo=Ar;var Nr=(Xt=l("cc.FogInfo"),qt=_(_t),Kt=E(),Qt=_(f),$t=S(),Jt=C(),te=k(),ee=E(),re=_(f),oe=C(),ie=k(),ne=E(),se=_(f),ae=C(),ce=k(),ue=E(),pe=_(f),he=I(),le=C(),_e=k(),fe=E(),ge=_(f),ye=C(),be=k(),me=E(),de=_(f),ve=C(),we=k(),Xt((Ae=je=function(){function t(){w(this,"_type",Ee,this),w(this,"_fogColor",Se,this),w(this,"_enabled",Ce,this),w(this,"_fogDensity",ke,this),w(this,"_fogStart",Ie,this),w(this,"_fogEnd",Pe,this),w(this,"_fogAtten",Le,this),w(this,"_fogTop",ze,this),w(this,"_fogRange",De,this),this._resource=null}return t.prototype.activate=function(t){this._resource=t,this._resource.initialize(this),this._resource.activate()},r(t,[{key:"enabled",set:function(t){this._enabled!==t&&(this._enabled=t,this._resource&&(this._resource.enabled=t,t&&(this._resource.type=this._type)))},get:function(){return this._enabled}},{key:"fogColor",set:function(t){this._fogColor.set(t),this._resource&&(this._resource.fogColor=this._fogColor)},get:function(){return this._fogColor}},{key:"type",get:function(){return this._type},set:function(t){this._type=t,this._resource&&(this._resource.type=t)}},{key:"fogDensity",get:function(){return this._fogDensity},set:function(t){this._fogDensity=t,this._resource&&(this._resource.fogDensity=t)}},{key:"fogStart",get:function(){return this._fogStart},set:function(t){this._fogStart=t,this._resource&&(this._resource.fogStart=t)}},{key:"fogEnd",get:function(){return this._fogEnd},set:function(t){this._fogEnd=t,this._resource&&(this._resource.fogEnd=t)}},{key:"fogAtten",get:function(){return this._fogAtten},set:function(t){this._fogAtten=t,this._resource&&(this._resource.fogAtten=t)}},{key:"fogTop",get:function(){return this._fogTop},set:function(t){this._fogTop=t,this._resource&&(this._resource.fogTop=t)}},{key:"fogRange",get:function(){return this._fogRange},set:function(t){this._fogRange=t,this._resource&&(this._resource.fogRange=t)}}]),t}(),je.FogType=_t,Ee=g((Oe=Ae).prototype,"_type",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return _t.LINEAR}}),Se=g(Oe.prototype,"_fogColor",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new T("#C8C8C8")}}),Ce=g(Oe.prototype,"_enabled",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ke=g(Oe.prototype,"_fogDensity",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.3}}),Ie=g(Oe.prototype,"_fogStart",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),Pe=g(Oe.prototype,"_fogEnd",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 300}}),Le=g(Oe.prototype,"_fogAtten",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),ze=g(Oe.prototype,"_fogTop",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1.5}}),De=g(Oe.prototype,"_fogRange",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1.2}}),g(Oe.prototype,"enabled",[y],Object.getOwnPropertyDescriptor(Oe.prototype,"enabled"),Oe.prototype),g(Oe.prototype,"fogColor",[y],Object.getOwnPropertyDescriptor(Oe.prototype,"fogColor"),Oe.prototype),g(Oe.prototype,"type",[y,qt],Object.getOwnPropertyDescriptor(Oe.prototype,"type"),Oe.prototype),g(Oe.prototype,"fogDensity",[Kt,Qt,$t,Jt,m,te],Object.getOwnPropertyDescriptor(Oe.prototype,"fogDensity"),Oe.prototype),g(Oe.prototype,"fogStart",[ee,re,oe,ie],Object.getOwnPropertyDescriptor(Oe.prototype,"fogStart"),Oe.prototype),g(Oe.prototype,"fogEnd",[ne,se,ae,ce],Object.getOwnPropertyDescriptor(Oe.prototype,"fogEnd"),Oe.prototype),g(Oe.prototype,"fogAtten",[ue,pe,he,le,_e],Object.getOwnPropertyDescriptor(Oe.prototype,"fogAtten"),Oe.prototype),g(Oe.prototype,"fogTop",[fe,ge,ye,be],Object.getOwnPropertyDescriptor(Oe.prototype,"fogTop"),Oe.prototype),g(Oe.prototype,"fogRange",[me,de,ve,we],Object.getOwnPropertyDescriptor(Oe.prototype,"fogRange"),Oe.prototype),Te=Oe))||Te),xr=(Ne=l("cc.ShadowsInfo"),xe=_(tt),Re=E(),Fe=_(f),Ue=E(),He=_(et),Me=E(),Be=_(d),We=E(),Ye=_(f),Ge=E(),Ve=_(f),Ze=E(),Xe=_(f),qe=E(),Ke=_(v),Qe=E(),$e=E(),Je=_(f),tr=E(),er=_(f),rr=E(),Ne((dr=function(){function t(){w(this,"_type",nr,this),w(this,"_enabled",sr,this),w(this,"_normal",ar,this),w(this,"_distance",cr,this),w(this,"_shadowColor",ur,this),w(this,"_autoAdapt",pr,this),w(this,"_pcf",hr,this),w(this,"_bias",lr,this),w(this,"_near",_r,this),w(this,"_far",fr,this),w(this,"_aspect",gr,this),w(this,"_orthoSize",yr,this),w(this,"_maxReceived",br,this),w(this,"_size",mr,this),this._resource=null}var e=t.prototype;return e.setPlaneFromNode=function(t){t.getWorldRotation(Dr),this.normal=p.transformQuat(zr,Lr,Dr),t.getWorldPosition(zr),this.distance=p.dot(this._normal,zr)},e.activate=function(t){this._resource=t,this._resource.initialize(this),this._resource.activate()},r(t,[{key:"enabled",set:function(t){this._enabled!==t&&(this._enabled=t,this._resource&&(this._resource.enabled=t,t&&(this._resource.type=this._type)))},get:function(){return this._enabled}},{key:"type",set:function(t){this._type=t,this._resource&&(this._resource.type=t)},get:function(){return this._type}},{key:"shadowColor",set:function(t){this._shadowColor.set(t),this._resource&&(this._resource.shadowColor=t)},get:function(){return this._shadowColor}},{key:"normal",set:function(t){p.copy(this._normal,t),this._resource&&(this._resource.normal=t)},get:function(){return this._normal}},{key:"distance",set:function(t){this._distance=t,this._resource&&(this._resource.distance=t)},get:function(){return this._distance}},{key:"pcf",set:function(t){this._pcf=t,this._resource&&(this._resource.pcf=t)},get:function(){return this._pcf}},{key:"autoAdapt",set:function(t){this._autoAdapt=t,this._resource&&(this._resource.autoAdapt=t)},get:function(){return this._autoAdapt}},{key:"near",set:function(t){this._near=t,this._resource&&(this._resource.near=t)},get:function(){return this._near}},{key:"far",set:function(t){this._far=t,this._resource&&(this._resource.far=t)},get:function(){return this._far}},{key:"orthoSize",set:function(t){this._orthoSize=t,this._resource&&(this._resource.orthoSize=t)},get:function(){return this._orthoSize}},{key:"maxReceived",set:function(t){this._maxReceived=t,this._resource&&(this._resource.maxReceived=t)},get:function(){return this._maxReceived}},{key:"shadowMapSize",set:function(t){this._size.set(t),this._resource&&(this._resource.size=t,this._resource.shadowMapDirty=!0)},get:function(){return this._size}},{key:"aspect",set:function(t){this._aspect=t,this._resource&&(this._resource.aspect=t)},get:function(){return this._aspect}},{key:"bias",set:function(t){this._bias=t,this._resource&&(this._resource.bias=t)},get:function(){return this._bias}}]),t}(),nr=g((ir=dr).prototype,"_type",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return tt.Planar}}),sr=g(ir.prototype,"_enabled",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ar=g(ir.prototype,"_normal",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new p(0,1,0)}}),cr=g(ir.prototype,"_distance",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ur=g(ir.prototype,"_shadowColor",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new T(0,0,0,76)}}),pr=g(ir.prototype,"_autoAdapt",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),hr=g(ir.prototype,"_pcf",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return et.HARD}}),lr=g(ir.prototype,"_bias",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1e-5}}),_r=g(ir.prototype,"_near",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),fr=g(ir.prototype,"_far",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 30}}),gr=g(ir.prototype,"_aspect",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),yr=g(ir.prototype,"_orthoSize",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),br=g(ir.prototype,"_maxReceived",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 4}}),mr=g(ir.prototype,"_size",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new e(512,512)}}),g(ir.prototype,"enabled",[y],Object.getOwnPropertyDescriptor(ir.prototype,"enabled"),ir.prototype),g(ir.prototype,"type",[y,xe],Object.getOwnPropertyDescriptor(ir.prototype,"type"),ir.prototype),g(ir.prototype,"shadowColor",[y],Object.getOwnPropertyDescriptor(ir.prototype,"shadowColor"),ir.prototype),g(ir.prototype,"normal",[Re],Object.getOwnPropertyDescriptor(ir.prototype,"normal"),ir.prototype),g(ir.prototype,"distance",[Fe,Ue],Object.getOwnPropertyDescriptor(ir.prototype,"distance"),ir.prototype),g(ir.prototype,"pcf",[He,Me],Object.getOwnPropertyDescriptor(ir.prototype,"pcf"),ir.prototype),g(ir.prototype,"autoAdapt",[Be,We],Object.getOwnPropertyDescriptor(ir.prototype,"autoAdapt"),ir.prototype),g(ir.prototype,"near",[Ye,Ge],Object.getOwnPropertyDescriptor(ir.prototype,"near"),ir.prototype),g(ir.prototype,"far",[Ve,Ze],Object.getOwnPropertyDescriptor(ir.prototype,"far"),ir.prototype),g(ir.prototype,"orthoSize",[Xe,qe],Object.getOwnPropertyDescriptor(ir.prototype,"orthoSize"),ir.prototype),g(ir.prototype,"maxReceived",[Ke,Qe],Object.getOwnPropertyDescriptor(ir.prototype,"maxReceived"),ir.prototype),g(ir.prototype,"shadowMapSize",[$e],Object.getOwnPropertyDescriptor(ir.prototype,"shadowMapSize"),ir.prototype),g(ir.prototype,"aspect",[Je,tr],Object.getOwnPropertyDescriptor(ir.prototype,"aspect"),ir.prototype),g(ir.prototype,"bias",[er,rr],Object.getOwnPropertyDescriptor(ir.prototype,"bias"),ir.prototype),or=ir))||or);i.ShadowsInfo=xr;var Rr,Fr,Ur,Hr,Mr,Br=(vr=l("cc.SceneGlobals"),wr=_(Ar),vr((Ir=function(){function t(){w(this,"ambient",Er,this),w(this,"shadows",Sr,this),w(this,"_skybox",Cr,this),w(this,"fog",kr,this)}return t.prototype.activate=function(){var t=i.director.root.pipeline;this.ambient.activate(t.ambient),this.skybox.activate(t.skybox),this.shadows.activate(t.shadows),this.fog.activate(t.fog)},r(t,[{key:"skybox",get:function(){return this._skybox},set:function(t){this._skybox=t}}]),t}(),Er=g((Or=Ir).prototype,"ambient",[O,y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new jr}}),Sr=g(Or.prototype,"shadows",[O,y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new xr}}),Cr=g(Or.prototype,"_skybox",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Ar}}),kr=g(Or.prototype,"fog",[y,O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Nr}}),g(Or.prototype,"skybox",[y,wr],Object.getOwnPropertyDescriptor(Or.prototype,"skybox"),Or.prototype),Tr=Or))||Tr);i.SceneGlobals=Br;var Wr,Yr=t("S",l("cc.Scene")((Mr=function(t){P(o,t);var e=o.prototype;function o(e){var r;return r=t.call(this,e)||this,w(r,"autoReleaseAssets",Ur,L(r)),w(r,"_globals",Hr,L(r)),r._renderScene=null,r.dependAssets=null,r._inited=void 0,r._prefabSyncedInLiveReload=!1,r._pos=p.ZERO,r._rot=h.IDENTITY,r._scale=p.ONE,r._mat=z.IDENTITY,r._dirtyFlags=0,r._activeInHierarchy=!1,i.director&&i.director.root&&(r._renderScene=i.director.root.createScene({})),r._inited=!i.game||!i.game._isCloning,r}return e._updateScene=function(){this._scene=this},r(o,[{key:"renderScene",get:function(){return this._renderScene}},{key:"globals",get:function(){return this._globals}}]),e.destroy=function(){var t=D.prototype.destroy.call(this);if(t)for(var e=this._children,r=0;r<e.length;++r)e[r].active=!1;return i.director.root.destroyScene(this._renderScene),this._active=!1,this._activeInHierarchy=!1,t},e.addComponent=function(){throw new Error(j(3822))},e._onHierarchyChanged=function(){},e._onBatchCreated=function(e){t.prototype._onBatchCreated.call(this,e);for(var r=this._children.length,o=0;o<r;++o)this._children[o]._onBatchCreated(e);A(this)},e.getPosition=function(t){return p.copy(t||new p,p.ZERO)},e.getRotation=function(t){return h.copy(t||new h,h.IDENTITY)},e.getScale=function(t){return p.copy(t||new p,p.ONE)},e.getWorldPosition=function(t){return p.copy(t||new p,p.ZERO)},e.getWorldRotation=function(t){return h.copy(t||new h,h.IDENTITY)},e.getWorldScale=function(t){return p.copy(t||new p,p.ONE)},e.getWorldMatrix=function(t){return z.copy(t||new z,z.IDENTITY)},e.getWorldRS=function(t){return z.copy(t||new z,z.IDENTITY)},e.getWorldRT=function(t){return z.copy(t||new z,z.IDENTITY)},e.updateWorldTransform=function(){},e._instantiate=function(){},e._load=function(){this._inited||(this._onBatchCreated(N),this._inited=!0),this.walk(lt._setScene)},e._activate=function(t){t=!1!==t,i.director._nodeActivator.activateNode(this,t),this._globals.activate()},r(o,[{key:"position",get:function(){return p.ZERO}},{key:"worldPosition",get:function(){return p.ZERO}},{key:"rotation",get:function(){return h.IDENTITY}},{key:"worldRotation",get:function(){return h.IDENTITY}},{key:"scale",get:function(){return p.ONE}},{key:"worldScale",get:function(){return p.ONE}},{key:"eulerAngles",get:function(){return p.ZERO}},{key:"worldMatrix",get:function(){return z.IDENTITY}}]),o}(lt),g((Fr=Mr).prototype,"globals",[y],Object.getOwnPropertyDescriptor(Fr.prototype,"globals"),Fr.prototype),Ur=g(Fr.prototype,"autoReleaseAssets",[O,y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Hr=g(Fr.prototype,"_globals",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Br}}),Rr=Fr))||Rr);i.Scene=Yr,D.Flags.HideInHierarchy;var Gr=t("P",l("cc.PrivateNode")(Wr=function(t){function e(e){return t.call(this,e)||this}return P(e,t),e}(ht))||Wr);i.PrivateNode=Gr;var Vr=x.fastRemoveAt,Zr=D.Flags.IsStartCalled,Xr=D.Flags.IsOnEnableCalled;function qr(t,e){for(var r=e.constructor._executionOrder,o=e._id,i=0,n=t.length-1,s=n>>>1;i<=n;s=i+n>>>1){var a=t[s],c=a.constructor._executionOrder;if(c>r)n=s-1;else if(c<r)i=s+1;else{var u=a._id;if(u>o)n=s-1;else{if(!(u<o))return s;i=s+1}}}return~i}function Kr(t,e){for(var r=t.array,o=t.i+1;o<r.length;){var i=r[o];i._enabled&&i.node._activeInHierarchy?++o:(t.removeAt(o),e&&(i._objFlags&=~e))}}D.Flags.IsEditorOnEnableCalled;var Qr=function(t){this._zero=void 0,this._neg=void 0,this._pos=void 0,this._invoke=void 0;var e=R;this._zero=new e([]),this._neg=new e([]),this._pos=new e([]),this._invoke=t};function $r(t,e){return t.constructor._executionOrder-e.constructor._executionOrder}Qr.stableRemoveInactive=Kr;var Jr=function(t){function e(){return t.apply(this,arguments)||this}P(e,t);var r=e.prototype;return r.add=function(t){var e=t.constructor._executionOrder;(0===e?this._zero:e<0?this._neg:this._pos).array.push(t)},r.remove=function(t){var e=t.constructor._executionOrder;(0===e?this._zero:e<0?this._neg:this._pos).fastRemove(t)},r.cancelInactive=function(t){Kr(this._zero,t),Kr(this._neg,t),Kr(this._pos,t)},r.invoke=function(){var t=this._neg;t.array.length>0&&(t.array.sort($r),this._invoke(t),t.array.length=0),this._invoke(this._zero),this._zero.array.length=0;var e=this._pos;e.array.length>0&&(e.array.sort($r),this._invoke(e),e.array.length=0)},e}(Qr),to=function(t){function e(){return t.apply(this,arguments)||this}P(e,t);var r=e.prototype;return r.add=function(t){var e=t.constructor._executionOrder;if(0===e)this._zero.array.push(t);else{var r=e<0?this._neg.array:this._pos.array,o=qr(r,t);o<0&&r.splice(~o,0,t)}},r.remove=function(t){var e=t.constructor._executionOrder;if(0===e)this._zero.fastRemove(t);else{var r=e<0?this._neg:this._pos,o=qr(r.array,t);o>=0&&r.removeAt(o)}},r.invoke=function(t){this._neg.array.length>0&&this._invoke(this._neg,t),this._invoke(this._zero,t),this._pos.array.length>0&&this._invoke(this._pos,t)},e}(Qr);function eo(t,e,r){return function(o,n){try{e(o,n)}catch(e){i._throw(e);var s=o.array;for(r&&(s[o.i]._objFlags|=r),++o.i;o.i<s.length;++o.i)try{t(s[o.i],n)}catch(t){i._throw(t),r&&(s[o.i]._objFlags|=r)}}}}var ro=eo((function(t){t.start(),t._objFlags|=Zr}),(function(t){var e=t.array;for(t.i=0;t.i<e.length;++t.i){var r=e[t.i];r.start(),r._objFlags|=Zr}}),Zr),oo=eo((function(t,e){t.update(e)}),(function(t,e){var r=t.array;for(t.i=0;t.i<r.length;++t.i)r[t.i].update(e)})),io=eo((function(t,e){t.lateUpdate(e)}),(function(t,e){var r=t.array;for(t.i=0;t.i<r.length;++t.i)r[t.i].lateUpdate(e)})),no=function(t){var e=i.director._compScheduler,r=t.array;for(t.i=0;t.i<r.length;++t.i){var o=r[t.i];o._enabled&&(o.onEnable(),!o.node._activeInHierarchy||e._onEnabled(o))}},so=(t("a",function(){function t(){this._deferredComps=[],this.unscheduleAll()}var e=t.prototype;return e.unscheduleAll=function(){this.startInvoker=new Jr(ro),this.updateInvoker=new to(oo),this.lateUpdateInvoker=new to(io),this._updating=!1},e._onEnabled=function(t){i.director.getScheduler().resumeTarget(t),t._objFlags|=Xr,this._updating?this._deferredComps.push(t):this._scheduleImmediate(t)},e._onDisabled=function(t){i.director.getScheduler().pauseTarget(t),t._objFlags&=~Xr;var e=this._deferredComps.indexOf(t);e>=0?Vr(this._deferredComps,e):(!t.start||t._objFlags&Zr||this.startInvoker.remove(t),t.update&&this.updateInvoker.remove(t),t.lateUpdate&&this.lateUpdateInvoker.remove(t))},e.enableComp=function(t,e){if(!(t._objFlags&Xr)){if(t.onEnable){if(e)return void e.add(t);if(t.onEnable(),!t.node._activeInHierarchy)return}this._onEnabled(t)}},e.disableComp=function(t){t._objFlags&Xr&&(t.onDisable&&t.onDisable(),this._onDisabled(t))},e.startPhase=function(){this._updating=!0,this.startInvoker.invoke(),this._startForNewComps()},e.updatePhase=function(t){this.updateInvoker.invoke(t)},e.lateUpdatePhase=function(t){this.lateUpdateInvoker.invoke(t),this._updating=!1,this._startForNewComps()},e._startForNewComps=function(){this._deferredComps.length>0&&(this._deferredSchedule(),this.startInvoker.invoke())},e._scheduleImmediate=function(t){"function"!=typeof t.start||t._objFlags&Zr||this.startInvoker.add(t),"function"==typeof t.update&&this.updateInvoker.add(t),"function"==typeof t.lateUpdate&&this.lateUpdateInvoker.add(t)},e._deferredSchedule=function(){for(var t=this._deferredComps,e=0,r=t.length;e<r;e++)this._scheduleImmediate(t[e]);t.length=0},t}()),D.Flags.IsPreloadStarted),ao=D.Flags.IsOnLoadStarted,co=D.Flags.IsOnLoadCalled,uo=D.Flags.Deactivating,po=function(t){function e(){return t.apply(this,arguments)||this}P(e,t);var r=e.prototype;return r.add=function(t){this._zero.array.push(t)},r.remove=function(t){this._zero.fastRemove(t)},r.cancelInactive=function(t){Qr.stableRemoveInactive(this._zero,t)},r.invoke=function(){this._invoke(this._zero),this._zero.array.length=0},e}(Qr),ho=eo((function(t){t.__preload()}),(function(t){var e=t.array;for(t.i=0;t.i<e.length;++t.i)e[t.i].__preload()})),lo=eo((function(t){t.onLoad(),t._objFlags|=co}),(function(t){var e=t.array;for(t.i=0;t.i<e.length;++t.i){var r=e[t.i];r.onLoad(),r._objFlags|=co}}),co),_o=new F(4);function fo(t,e,r){e?t._removeComponent(e):x.removeAt(t._components,r)}_o.get=function(){var t=this._get()||{preload:new po(ho),onLoad:new Jr(lo),onEnable:new Jr(no)};t.preload._zero.i=-1;var e=t.onLoad;return e._zero.i=-1,e._neg.i=-1,e._pos.i=-1,(e=t.onEnable)._zero.i=-1,e._neg.i=-1,e._pos.i=-1,t},t("N",function(){function t(){this.resetComp=void 0,this.reset()}var e=t.prototype;return e.reset=function(){this._activatingStack=[]},e.activateNode=function(t,e){if(e){var r=_o.get();this._activatingStack.push(r),this._activateNodeRecursively(t,r.preload,r.onLoad,r.onEnable),r.preload.invoke(),r.onLoad.invoke(),r.onEnable.invoke(),this._activatingStack.pop(),_o.put(r)}else{this._deactivateNodeRecursively(t);for(var o,i=this._activatingStack,n=U(i);!(o=n()).done;){var s=o.value;s.preload.cancelInactive(so),s.onLoad.cancelInactive(ao),s.onEnable.cancelInactive()}}t.emit("active-in-hierarchy-changed",t)},e.activateComp=function(t,e,r,o){if(H(t,!0)&&(t._objFlags&so||(t._objFlags|=so,t.__preload&&(e?e.add(t):t.__preload())),t._objFlags&ao||(t._objFlags|=ao,t.onLoad?r?r.add(t):(t.onLoad(),t._objFlags|=co):t._objFlags|=co),t._enabled)){if(!t.node._activeInHierarchy)return;i.director._compScheduler.enableComp(t,o)}},e.destroyComp=function(t){i.director._compScheduler.disableComp(t),t.onDestroy&&t._objFlags&co&&t.onDestroy()},e._activateNodeRecursively=function(t,e,r,o){if(t._objFlags&uo)n(3816,t.name);else{t._activeInHierarchy=!0;for(var s=t._components.length,a=0;a<s;++a){var c=t._components[a];c instanceof i.Component?this.activateComp(c,e,r,o):(fo(t,c,a),--a,--s)}t._childArrivalOrder=t._children.length;for(var u=0,p=t._children.length;u<p;++u){var h=t._children[u];h._active&&this._activateNodeRecursively(h,e,r,o)}t._onPostActivated(!0)}},e._deactivateNodeRecursively=function(t){t._objFlags|=uo,t._activeInHierarchy=!1;for(var e=t._components.length,r=0;r<e;++r){var o=t._components[r];if(o._enabled&&(i.director._compScheduler.disableComp(o),t._activeInHierarchy))return void(t._objFlags&=~uo)}for(var n=0,s=t._children.length;n<s;++n){var a=t._children[n];if(a._activeInHierarchy&&(this._deactivateNodeRecursively(a),t._activeInHierarchy))return void(t._objFlags&=~uo)}t._onPostActivated(!1),t._objFlags&=~uo},t}());var go,yo,bo,mo,vo,wo,To,Oo,Eo,So,Co,ko,Io,Po,Lo,zo,Do,jo,Ao,No,xo,Ro,Fo,Uo,Ho,Mo,Bo,Wo,Yo,Go,Vo,Zo,Xo,qo,Ko,Qo,$o,Jo,ti,ei,ri,oi,ii,ni,si,ai,ci,ui,pi,hi,li,_i,fi,gi,yi,bi,mi,di,vi,wi,Ti,Oi,Ei,Si,Ci,ki,Ii,Pi=new p,Li=M(ot),zi=M(it),Di=M(nt),ji=M(st),Ai=M(at),Ni=M({SKYBOX:ct|B.DEPTH_STENCIL,SOLID_COLOR:B.ALL,DEPTH_ONLY:B.DEPTH_STENCIL,DONT_CLEAR:B.NONE}),xi=t("C",(go=l("cc.Camera"),yo=V(),bo=Z(),mo=k(),vo=X(),wo=_(u.BitMask),To=k(),Oo=X(),Eo=_(Ni),So=k(),Co=X(),ko=k(),Io=X(),Po=k(),Lo=X(),zo=k(),Do=X(),jo=_(Li),Ao=k(),No=X(),xo=_(zi),Ro=k(),Fo=X(),Uo=k(),Ho=X(),Mo=k(),Bo=X(),Wo=k(),Yo=X(),Go=k(),Vo=X(),Zo=_(Di),Xo=k(),qo=X(),Ko=_(ji),Qo=k(),$o=X(),Jo=_(Ai),ti=k(),ei=X(),ri=k(),oi=X(),ii=_(W),ni=k(),si=X(),go(ai=yo(ai=bo(ai=Y((Ii=ki=function(t){function e(){for(var e,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o))||this,w(e,"_projection",ui,L(e)),w(e,"_priority",pi,L(e)),w(e,"_fov",hi,L(e)),w(e,"_fovAxis",li,L(e)),w(e,"_orthoHeight",_i,L(e)),w(e,"_near",fi,L(e)),w(e,"_far",gi,L(e)),w(e,"_color",yi,L(e)),w(e,"_depth",bi,L(e)),w(e,"_stencil",mi,L(e)),w(e,"_clearFlags",di,L(e)),w(e,"_rect",vi,L(e)),w(e,"_aperture",wi,L(e)),w(e,"_shutter",Ti,L(e)),w(e,"_iso",Oi,L(e)),w(e,"_screenScale",Ei,L(e)),w(e,"_visibility",Si,L(e)),w(e,"_targetTexture",Ci,L(e)),e._camera=null,e._inEditorMode=!1,e._flows=void 0,e}P(e,t);var o=e.prototype;return o.onLoad=function(){this._createCamera()},o.onEnable=function(){this.node.hasChangedFlags|=ut.POSITION,this._camera&&this._attachToScene()},o.onDisable=function(){this._camera&&this._detachFromScene()},o.onDestroy=function(){this._camera&&(this._camera.destroy(),this._camera=null),this._targetTexture&&this._targetTexture.off("resize")},o.screenPointToRay=function(t,e,r){return r||(r=pt.create()),this._camera&&this._camera.screenPointToRay(r,t,e),r},o.worldToScreen=function(t,e){return e||(e=new p),this._camera&&this._camera.worldToScreen(e,t),e},o.screenToWorld=function(t,e){return e||(e=this.node.getWorldPosition()),this._camera&&this._camera.screenToWorld(e,t),e},o.convertToUINode=function(t,e,r){if(r||(r=new p),!this._camera)return r;this.worldToScreen(t,Pi);var o=e.getComponent("cc.UITransform"),n=ft.getVisibleSize(),s=Pi.x-.5*this._camera.width,a=Pi.y-.5*this._camera.height;return Pi.x=s/i.view.getScaleX()+.5*n.width,Pi.y=a/i.view.getScaleY()+.5*n.height,o&&o.convertToNodeSpaceAR(Pi,r),r},o._createCamera=function(){this._camera||(this._camera=i.director.root.createCamera(),this._camera.initialize({name:this.node.name,node:this.node,projection:this._projection,window:this._inEditorMode?i.director.root&&i.director.root.mainWindow:i.director.root&&i.director.root.tempWindow,priority:this._priority}),this._camera.viewport=this._rect,this._camera.fovAxis=this._fovAxis,this._camera.fov=G(this._fov),this._camera.orthoHeight=this._orthoHeight,this._camera.nearClip=this._near,this._camera.farClip=this._far,this._camera.clearColor=this._color,this._camera.clearDepth=this._depth,this._camera.clearStencil=this._stencil,this._camera.clearFlag=this._clearFlags,this._camera.visibility=this._visibility,this._camera.aperture=this._aperture,this._camera.shutter=this._shutter,this._camera.iso=this._iso),this._updateTargetTexture()},o._attachToScene=function(){this.node.scene&&this._camera&&(this._camera&&this._camera.scene&&this._camera.scene.removeCamera(this._camera),this._getRenderScene().addCamera(this._camera))},o._detachFromScene=function(){this._camera&&this._camera.scene&&this._camera.scene.removeCamera(this._camera)},o._chechTargetTextureEvent=function(t){var e=this;t&&t.off("resize"),this._targetTexture&&this._targetTexture.on("resize",(function(t){e._camera&&e._camera.setFixedSize(t.width,t.height)}),this)},o._updateTargetTexture=function(){if(this._camera&&this._targetTexture){var t=this._targetTexture.window;this._camera.changeTargetWindow(t),this._camera.setFixedSize(t.width,t.height)}},r(e,[{key:"camera",get:function(){return this._camera}},{key:"priority",get:function(){return this._priority},set:function(t){this._priority=t,this._camera&&(this._camera.priority=t)}},{key:"visibility",get:function(){return this._visibility},set:function(t){this._visibility=t,this._camera&&(this._camera.visibility=t)}},{key:"clearFlags",get:function(){return this._clearFlags},set:function(t){this._clearFlags=t,this._camera&&(this._camera.clearFlag=t)}},{key:"clearColor",get:function(){return this._color},set:function(t){this._color.set(t),this._camera&&(this._camera.clearColor=this._color)}},{key:"clearDepth",get:function(){return this._depth},set:function(t){this._depth=t,this._camera&&(this._camera.clearDepth=t)}},{key:"clearStencil",get:function(){return this._stencil},set:function(t){this._stencil=t,this._camera&&(this._camera.clearStencil=t)}},{key:"projection",get:function(){return this._projection},set:function(t){this._projection=t,this._camera&&(this._camera.projectionType=t)}},{key:"fovAxis",get:function(){return this._fovAxis},set:function(t){t!==this._fovAxis&&(this._fovAxis=t,this._camera&&(this._camera.fovAxis=t,t===it.VERTICAL?this.fov=this._fov*this._camera.aspect:this.fov=this._fov/this._camera.aspect))}},{key:"fov",get:function(){return this._fov},set:function(t){this._fov=t,this._camera&&(this._camera.fov=G(t))}},{key:"orthoHeight",get:function(){return this._orthoHeight},set:function(t){this._orthoHeight=t,this._camera&&(this._camera.orthoHeight=t)}},{key:"near",get:function(){return this._near},set:function(t){this._near=t,this._camera&&(this._camera.nearClip=t)}},{key:"far",get:function(){return this._far},set:function(t){this._far=t,this._camera&&(this._camera.farClip=t)}},{key:"aperture",get:function(){return this._aperture},set:function(t){this._aperture=t,this._camera&&(this._camera.aperture=t)}},{key:"shutter",get:function(){return this._shutter},set:function(t){this._shutter=t,this._camera&&(this._camera.shutter=t)}},{key:"iso",get:function(){return this._iso},set:function(t){this._iso=t,this._camera&&(this._camera.iso=t)}},{key:"rect",get:function(){return this._rect},set:function(t){this._rect=t,this._camera&&(this._camera.viewport=t)}},{key:"targetTexture",get:function(){return this._targetTexture},set:function(t){if(this._targetTexture!==t){var e=this._targetTexture;this._targetTexture=t,this._chechTargetTextureEvent(e),this._updateTargetTexture(),!t&&this._camera&&(this._camera.changeTargetWindow(null),this._camera.isWindowSize=!0)}}},{key:"screenScale",get:function(){return this._screenScale},set:function(t){this._screenScale=t,this._camera&&(this._camera.screenScale=t)}},{key:"inEditorMode",get:function(){return this._inEditorMode},set:function(t){this._inEditorMode=t,this._camera&&this._camera.changeTargetWindow(t?i.director.root&&i.director.root.mainWindow:i.director.root&&i.director.root.tempWindow)}}]),e}(q),ki.ProjectionType=Li,ki.FOVAxis=zi,ki.ClearFlag=Ni,ki.Aperture=Di,ki.Shutter=ji,ki.ISO=Ai,ui=g((ci=Ii).prototype,"_projection",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Li.PERSPECTIVE}}),pi=g(ci.prototype,"_priority",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),hi=g(ci.prototype,"_fov",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 45}}),li=g(ci.prototype,"_fovAxis",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return zi.VERTICAL}}),_i=g(ci.prototype,"_orthoHeight",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),fi=g(ci.prototype,"_near",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),gi=g(ci.prototype,"_far",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1e3}}),yi=g(ci.prototype,"_color",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new T("#333333")}}),bi=g(ci.prototype,"_depth",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),mi=g(ci.prototype,"_stencil",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),di=g(ci.prototype,"_clearFlags",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Ni.SOLID_COLOR}}),vi=g(ci.prototype,"_rect",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new K(0,0,1,1)}}),wi=g(ci.prototype,"_aperture",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Di.F16_0}}),Ti=g(ci.prototype,"_shutter",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ji.D125}}),Oi=g(ci.prototype,"_iso",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Ai.ISO100}}),Ei=g(ci.prototype,"_screenScale",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Si=g(ci.prototype,"_visibility",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Q}}),Ci=g(ci.prototype,"_targetTexture",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g(ci.prototype,"priority",[mo,vo],Object.getOwnPropertyDescriptor(ci.prototype,"priority"),ci.prototype),g(ci.prototype,"visibility",[wo,To,Oo],Object.getOwnPropertyDescriptor(ci.prototype,"visibility"),ci.prototype),g(ci.prototype,"clearFlags",[Eo,So,Co],Object.getOwnPropertyDescriptor(ci.prototype,"clearFlags"),ci.prototype),g(ci.prototype,"clearColor",[ko,Io],Object.getOwnPropertyDescriptor(ci.prototype,"clearColor"),ci.prototype),g(ci.prototype,"clearDepth",[Po,Lo],Object.getOwnPropertyDescriptor(ci.prototype,"clearDepth"),ci.prototype),g(ci.prototype,"clearStencil",[zo,Do],Object.getOwnPropertyDescriptor(ci.prototype,"clearStencil"),ci.prototype),g(ci.prototype,"projection",[jo,Ao,No],Object.getOwnPropertyDescriptor(ci.prototype,"projection"),ci.prototype),g(ci.prototype,"fovAxis",[xo,Ro,Fo],Object.getOwnPropertyDescriptor(ci.prototype,"fovAxis"),ci.prototype),g(ci.prototype,"fov",[Uo,Ho],Object.getOwnPropertyDescriptor(ci.prototype,"fov"),ci.prototype),g(ci.prototype,"orthoHeight",[Mo,Bo],Object.getOwnPropertyDescriptor(ci.prototype,"orthoHeight"),ci.prototype),g(ci.prototype,"near",[Wo,Yo],Object.getOwnPropertyDescriptor(ci.prototype,"near"),ci.prototype),g(ci.prototype,"far",[Go,Vo],Object.getOwnPropertyDescriptor(ci.prototype,"far"),ci.prototype),g(ci.prototype,"aperture",[Zo,Xo,qo],Object.getOwnPropertyDescriptor(ci.prototype,"aperture"),ci.prototype),g(ci.prototype,"shutter",[Ko,Qo,$o],Object.getOwnPropertyDescriptor(ci.prototype,"shutter"),ci.prototype),g(ci.prototype,"iso",[Jo,ti,ei],Object.getOwnPropertyDescriptor(ci.prototype,"iso"),ci.prototype),g(ci.prototype,"rect",[ri,oi],Object.getOwnPropertyDescriptor(ci.prototype,"rect"),ci.prototype),g(ci.prototype,"targetTexture",[ii,ni,si],Object.getOwnPropertyDescriptor(ci.prototype,"targetTexture"),ci.prototype),ai=ci))||ai)||ai)||ai)||ai));i.Camera=xi}}}));
